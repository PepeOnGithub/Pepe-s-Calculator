<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pepe's Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="calculator-container">
        <div class="calculator-glass">
            <div class="calculator-header">
                <button id="theme-toggle" class="icon-button">
                    <i class="fas fa-moon"></i>
                </button>
                <h2>CyberCalc</h2>
                <div class="calc-history"></div>
            </div>
            
            <div class="calculator">
                <div class="output">
                    <input type="text" id="result" value="0" disabled>
                    <div class="expression-preview" id="expression"></div>
                </div>
                
                <div class="keys">
                    <button class="button sci" onclick="handleScientific('log(')">log</button>
                    <button class="button sci" onclick="handleScientific('sin(')">sin</button>
                    <button class="button sci" onclick="handleScientific('cos(')">cos</button>
                    <button class="button sci" onclick="handleScientific('tan(')">tan</button>
                    <button class="button sci" onclick="appendInput('Ï€')">Ï€</button>
                    <button class="button sci" onclick="appendInput('^')">x^y</button>
                    <button class="button sci" onclick="appendInput('sqrt(')">âˆš</button>
                    <button class="button sci" onclick="appendInput('!')">!</button>
                    
                    <button class="button num" onclick="appendInput('7')">7</button>
                    <button class="button num" onclick="appendInput('8')">8</button>
                    <button class="button num" onclick="appendInput('9')">9</button>
                    <button class="button op" onclick="appendInput('/')">Ã·</button>
                    
                    <button class="button num" onclick="appendInput('4')">4</button>
                    <button class="button num" onclick="appendInput('5')">5</button>
                    <button class="button num" onclick="appendInput('6')">6</button>
                    <button class="button op" onclick="appendInput('*')">Ã—</button>
                    
                    <button class="button num" onclick="appendInput('1')">1</button>
                    <button class="button num" onclick="appendInput('2')">2</button>
                    <button class="button num" onclick="appendInput('3')">3</button>
                    <button class="button op" onclick="appendInput('-')">-</button>
                    
                    <button class="button num" onclick="appendInput('.')">.</button>
                    <button class="button num" onclick="appendInput('0')">0</button>
                    <button class="button eq" onclick="calculate()">=</button>
                    <button class="button op" onclick="appendInput('+')">+</button>
                    
                    <button class="button control" onclick="clearResult()">C</button>
                    <button class="button control" onclick="backspace()">âŒ«</button>
                    <button class="button control" onclick="toggleDegrees()" id="deg-rad">DEG</button>
                    <button class="button control" onclick="showHistory()">ðŸ“œ</button>
                </div>
            </div>
        </div>
    </div>
    <script>
// script.js
let input = '';
let isDegree = true;
let history = [];

function appendInput(value) {
    if (value === 'Ï€') input += Math.PI;
    else input += value;
    updateDisplay();
}

function handleScientific(func) {
    input += func;
    updateDisplay();
}

function toggleDegrees() {
    isDegree = !isDegree;
    document.getElementById('deg-rad').textContent = isDegree ? 'DEG' : 'RAD';
}

function updateDisplay() {
    document.getElementById('result').value = input;
    document.getElementById('expression').textContent = input;
}

function clearResult() {
    input = '';
    updateDisplay();
}

function backspace() {
    input = input.slice(0, -1);
    updateDisplay();
}

function calculate() {
    try {
        let expression = input
            .replace(/sin\(/g, isDegree ? 'Math.sin(Math.PI/180*' : 'Math.sin(')
            .replace(/cos\(/g, isDegree ? 'Math.cos(Math.PI/180*' : 'Math.cos(')
            .replace(/tan\(/g, isDegree ? 'Math.tan(Math.PI/180*' : 'Math.tan(')
            .replace(/(\d+)!/g, (_, n) => `factorial(${n})`)
            .replace(/\^/g, '**');

        const factorial = (n) => n <= 1 ? 1 : n * factorial(n - 1);
        const result = Function(`'use strict'; return (${expression})`)()();
        
        history.push(`${input} = ${result}`);
        input = result.toString();
        updateDisplay();
    } catch (e) {
        alert('Error: Invalid expression');
        console.error(e);
    }
}

function showHistory() {
    const historyDiv = document.querySelector('.calc-history');
    historyDiv.innerHTML = history.join('<br>');
    historyDiv.style.display = historyDiv.style.display === 'block' ? 'none' : 'block';
}

// Theme toggle
document.getElementById('theme-toggle').addEventListener('click', () => {
    document.body.classList.toggle('light-mode');
    const icon = document.querySelector('#theme-toggle i');
    icon.classList.toggle('fa-moon');
    icon.classList.toggle('fa-sun');
});

// Keyboard support
document.addEventListener('keydown', (e) => {
    if (e.key >= '0' && e.key <= '9' || ['+', '-', '*', '/', '.'].includes(e.key)) {
        appendInput(e.key);
    } else if (e.key === 'Enter') {
        calculate();
    } else if (e.key === 'Backspace') {
        backspace();
    } else if (e.key === 'Escape') {
        clearResult();
    }
});
</script>
</body>
</html>
